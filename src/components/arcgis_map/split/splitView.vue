<style>
#mapviewbase {
    width: 100%;
    height: 100%;
}

/*分屏样式*/
/*1*/
.mapone {
    position: absolute;
    left: 0px;
    width: 100%;
    height: 100%;
    bottom: 0px;
    /*border: 1px solid #186fdc;*/
}

/*2*/
.maplefttwo {
    position: absolute;
    left: 0px;
    width: 50%;
    height: 100%;
    top: 0px;
    border: 1px solid #186fdc;
}

.maprighttwo {
    position: absolute;
    right: 0px;
    width: 50%;
    height: 100%;
    top: 0px;
    border: 1px solid #186fdc;
}

/*3*/
.mapleftthree {
    position: absolute;
    left: 0px;
    width: 50%;
    height: 100%;
    top: 0px;
    border: 1px solid #186fdc;
}

.mapright1three {
    position: absolute;
    right: 0px;
    width: 50%;
    height: 50%;
    top: 0px;
    border: 1px solid #186fdc;
}

.mapright2three {
    position: absolute;
    right: 0px;
    width: 50%;
    height: 50%;
    bottom: 0px;
    border: 1px solid #186fdc;
}

/*4*/
.mapleft1four {
    position: absolute;
    left: 0px;
    width: 50%;
    height: 50%;
    top: 0px;
    border: 1px solid #186fdc;
}

.mapleft2four {
    position: absolute;
    left: 0px;
    width: 50%;
    height: 50%;
    bottom: 0px;
    border: 1px solid #186fdc;
}

.mapright1four {
    position: absolute;
    right: 0px;
    width: 50%;
    height: 50%;
    top: 0px;
    border: 1px solid #186fdc;
}

.mapright2four {
    position: absolute;
    right: 0px;
    width: 50%;
    height: 50%;
    bottom: 0px;
    border: 1px solid #186fdc;
}

/*5*/
.mapleft1five {
    position: absolute;
    left: 0px;
    width: 33.33%;
    height: 100%;
    bottom: 0px;
    border: 1px solid #186fdc;
}

.mapleft2topfive {
    position: absolute;
    left: 33.33%;
    width: 33.33%;
    height: 50%;
    top: 0px;
    border: 1px solid #186fdc;
}

.mapleft2bottomfive {
    position: absolute;
    left: 33.33%;
    width: 33.33%;
    height: 50%;
    bottom: 0px;
    border: 1px solid #186fdc;
}

.mapright1five {
    position: absolute;
    left: 66.66%;
    width: 33.33%;
    height: 50%;
    top: 0px;
    border: 1px solid #186fdc;
}

.mapright2five {
    position: absolute;
    left: 66.66%;
    width: 33.33%;
    height: 50%;
    bottom: 0px;
    border: 1px solid #186fdc;
}

/*6*/
.map1six {
    position: absolute;
    left: 0px;
    width: 33.33%;
    height: 50%;
    top: 0px;
    border: 1px solid #186fdc;
}

.map2six {
    position: absolute;
    left: 33.33%;
    width: 33.33%;
    height: 50%;
    top: 0px;
    border: 1px solid #186fdc;
}

.map3six {
    position: absolute;
    left: 66.66%;
    width: 33.33%;
    height: 50%;
    top: 0px;
    border: 1px solid #186fdc;
}

.map4six {
    position: absolute;
    left: 66.66%;
    width: 33.33%;
    height: 50%;
    bottom: 0px;
    border: 1px solid #186fdc;
}

.map5six {
    position: absolute;
    left: 33.33%;
    width: 33.33%;
    height: 50%;
    bottom: 0px;
    border: 1px solid #186fdc;
}

.map6six {
    position: absolute;
    left: 0px;
    width: 33.33%;
    height: 50%;
    bottom: 0px;
    border: 1px solid #186fdc;
}

/*7*/
.map1seven {
    position: absolute;
    left: 0px;
    width: 33.33%;
    height: 100%;
    top: 0px;
    border: 1px solid #186fdc;
}

.map2seven {
    position: absolute;
    left: 33.33%;
    width: 33.33%;
    height: 33.33%;
    top: 0px;
    border: 1px solid #186fdc;
}

.map3seven {
    position: absolute;
    left: 66.66%;
    width: 33.33%;
    height: 33.33%;
    top: 0px;
    border: 1px solid #186fdc;
}

.map4seven {
    position: absolute;
    left: 33.33%;
    width: 33.33%;
    height: 33.33%;
    top: 33.3%;
    border: 1px solid #186fdc;
}

.map5seven {
    position: absolute;
    left: 66.66%;
    width: 33.33%;
    height: 33.33%;
    top: 33.33%;
    border: 1px solid #186fdc;
}

.map6seven {
    position: absolute;
    left: 33.33%;
    width: 33.33%;
    height: 33.33%;
    bottom: 0px;
    border: 1px solid #186fdc;
}

.map7seven {
    position: absolute;
    left: 66.66%;
    width: 33.33%;
    height: 33.33%;
    bottom: 0px;
    border: 1px solid #186fdc;
}

/*8*/
.map1eight {
    position: absolute;
    left: 0px;
    width: 33.33%;
    height: 50%;
    top: 0px;
    border: 1px solid #186fdc;
}

.map2eight {
    position: absolute;
    left: 33.33%;
    width: 33.33%;
    height: 33.33%;
    top: 0px;
    border: 1px solid #186fdc;
}

.map3eight {
    position: absolute;
    left: 66.66%;
    width: 33.33%;
    height: 33.33%;
    top: 0px;
    border: 1px solid #186fdc;
}

.map4eight {
    position: absolute;
    left: 33.33%;
    width: 33.33%;
    height: 33.33%;
    top: 33.33%;
    border: 1px solid #186fdc;
}

.map5eight {
    position: absolute;
    left: 66.66%;
    width: 33.33%;
    height: 33.33%;
    top: 33.33%;
    border: 1px solid #186fdc;
}

.map6eight {
    position: absolute;
    left: 33.33%;
    width: 33.33%;
    height: 33.33%;
    bottom: 0px;
    border: 1px solid #186fdc;
}

.map7eight {
    position: absolute;
    left: 66.66%;
    width: 33.33%;
    height: 33.33%;
    bottom: 0px;
    border: 1px solid #186fdc;
}

.map8eight {
    position: absolute;
    left: 0px;
    width: 33.33%;
    height: 50%;
    bottom: 0px;
    border: 1px solid #186fdc;
}

/*9*/
.map1nine {
    position: absolute;
    left: 0px;
    width: 33.33%;
    height: 33.33%;
    top: 0px;
    border: 1px solid #186fdc;
}

.map2nine {
    position: absolute;
    left: 33.33%;
    width: 33.33%;
    height: 33.33%;
    top: 0px;
    border: 1px solid #186fdc;
}

.map3nine {
    position: absolute;
    left: 66.66%;
    width: 33.33%;
    height: 33.33%;
    top: 0px;
    border: 1px solid #186fdc;
}

.map4nine {
    position: absolute;
    left: 0px;
    width: 33.33%;
    height: 33.33%;
    top: 33.33%;
    border: 1px solid #186fdc;
}

.map5nine {
    position: absolute;
    left: 33.33%;
    width: 33.33%;
    height: 33.33%;
    top: 33.33%;
    border: 1px solid #186fdc;
}

.map6nine {
    position: absolute;
    left: 66.66%;
    width: 33.33%;
    height: 33.33%;
    top: 33.33%;
    border: 1px solid #186fdc;
}

.map7nine {
    position: absolute;
    left: 0px;
    width: 33.33%;
    height: 33.33%;
    bottom: 0px;
    border: 1px solid #186fdc;
}

.map8nine {
    position: absolute;
    left: 33.33%;
    width: 33.33%;
    height: 33.33%;
    bottom: 0px;
    border: 1px solid #186fdc;
}

.map9nine {
    position: absolute;
    left: 66.66%;
    width: 33.33%;
    height: 33.33%;
    bottom: 0px;
    border: 1px solid #186fdc;
}
</style>
<template>
    <div id="mapviewbase">
        <template v-if="items.length == 1" v-for="(item, index) in items">
            <mapview :id="item" class="mapone"></mapview>
        </template>
        <template v-if="items.length == 2" v-for="(item, index) in items">
            <mapview :id="item" :class="{ 'maplefttwo': index == 0, 'maprighttwo': index == 1 }"></mapview>
        </template>
        <template v-if="items.length == 3" v-for="(item, index) in items">
            <mapview :id="item"
                :class="{ 'mapleftthree': index == 0, 'mapright1three': index == 1, 'mapright2three': index == 2 }">
            </mapview>
        </template>
        <template v-if="items.length == 4" v-for="(item, index) in items">
            <mapview :id="item"
                :class="{ 'mapleft1four': index == 0, 'mapright1four': index == 1, 'mapright2four': index == 2, 'mapleft2four': index == 3 }">
            </mapview>
        </template>
        <template v-if="items.length == 5" v-for="(item, index) in items">
            <mapview :id="item"
                :class="{ 'mapleft1five': index == 0, 'mapleft2topfive': index == 1, 'mapright1five': index == 2, 'mapright2five': index == 3, 'mapleft2bottomfive': index == 4 }">
            </mapview>
        </template>
        <template v-if="items.length == 6" v-for="(item, index) in items">
            <mapview :id="item"
                :class="{ 'map1six': index == 0, 'map2six': index == 1, 'map3six': index == 2, 'map4six': index == 3, 'map5six': index == 4, 'map6six': index == 5 }">
            </mapview>
        </template>
        <template v-if="items.length == 7" v-for="(item, index) in items">
            <mapview :id="item"
                :class="{ 'map1seven': index == 0, 'map2seven': index == 1, 'map3seven': index == 2, 'map4seven': index == 3, 'map5seven': index == 4, 'map6seven': index == 5, 'map7seven': index == 6 }">
            </mapview>
        </template>
        <template v-if="items.length == 8" v-for="(item, index) in items">
            <mapview :id="item"
                :class="{ 'map1eight': index == 0, 'map2eight': index == 1, 'map3eight': index == 2, 'map4eight': index == 3, 'map5eight': index == 4, 'map6eight': index == 5, 'map7eight': index == 6, 'map8eight': index == 7 }">
            </mapview>
        </template>
        <template v-if="items.length == 9" v-for="(item, index) in items">
            <mapview :id="item"
                :class="{ 'map1nine': index == 0, 'map2nine': index == 1, 'map3nine': index == 2, 'map4nine': index == 3, 'map5nine': index == 4, 'map6nine': index == 5, 'map7nine': index == 6, 'map8nine': index == 7, 'map9nine': index == 8 }">
            </mapview>
        </template>
    </div>
</template>
<script>

import mapview from "./splitMap";
import bus from "../../../eventBus.js";
import { MapControl } from "../js/MapControl";
import mapconfig from "../js/mapconfig";

export default {
    components: { mapview },
    name: 'splitview',
    props: {
        items: Array
    },
    data() {
        return {
            startid: "", //记录开始变化的id
            endid: "", //记录变化后的id
        };
    },
    methods: {
        clearMapControl() {
            mapconfig.MapControl = {}; //置空
            mapconfig.MapControl1 = {}; //置空
        },
        isEmptyObject(obj) {
            for (var key in obj) {
                return false;
            }
            return true;
        },
        isEmptyObject2key(obj, keyname) {
            for (var key in obj) {
                if (key == keyname) return true;
            }
            return false;
        },
        getmapid(value) {
            this.startid = value;
            for (let key in mapconfig.MapControl) {
                if (key == value) mapconfig.MapControl[key] = true;
                else mapconfig.MapControl[key] = false;
            } //第一次切换地图窗口时，以切换后的窗体作为主体，同步其他窗口
        },
        ExtentChange(value) {
            if (!mapconfig.MapControl1[value.id]) return;

            if (
                this.isEmptyObject(mapconfig.MapControl) ||
                !this.isEmptyObject2key(mapconfig.MapControl, value.id)
            ) {
                mapconfig.MapControl[value.id] = false;
                if (
                    this.items.length > 1 &&
                    this.items.length == Object.getOwnPropertyNames(mapconfig.MapControl).length
                ) {
                    mapconfig.MapControl[value.id] = true;
                    MapControl.ExtentChange(value.event, this.items);
                    bus.$off("ExtentChange", "off");
                }
            }
            if (this.items.length < 2) {
                // bus.$off("ExtentChange", "off");
                return;
            }
            if (this.startid != value.id) {
                // bus.$off("ExtentChange", "off");
                return;
            }
            //当鼠标在同一个地图窗口中；地图四角坐标变化，将重置地图窗口同步要素；
            MapControl.ExtentChange(value.event, this.items);
        },
    },
    mounted() {
        this.clearMapControl();
        bus.$on("getmapid", this.getmapid);
        bus.$on("ExtentChange", this.ExtentChange);
    },
    beforeDestroy() {
        bus.$off("getmapid", this.getmapid);
        bus.$off("ExtentChange", this.ExtentChange);
    }
};
</script>